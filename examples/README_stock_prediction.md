# Kronos 交互式股票预测系统 使用说明

## 📖 简介

这是一个基于Kronos时间序列预测模型的交互式股票预测程序。该程序能够：

- ✅ 使用akshare自动下载最近100个交易日的K线数据
- ✅ 预测未来1个月（约20个交易日）的股票走势
- ✅ 支持单个股票代码输入和批量预测
- ✅ 自动保存预测结果（CSV文件）和可视化图表（PNG图片）
- ✅ 应用中国A股涨跌幅限制（±10%）

## 🚀 快速开始

### 1. 环境准备

确保已安装所需依赖：

```bash
pip install pandas numpy akshare matplotlib torch
```

### 2. 模型文件

确保已下载Kronos模型文件到 `NeoQuasar/` 目录：
- `NeoQuasar/Kronos-Tokenizer-base/`
- `NeoQuasar/Kronos-base/`

### 3. 运行程序

```bash
cd examples
python stock_prediction_interactive.py
```

## 📋 使用方法

### 方式1: 输入单个股票代码

1. 运行程序后，选择 `[1] 输入单个股票代码`
2. 输入股票代码（如：`000001`, `600000`, `002594`等）
3. 程序会自动下载数据、执行预测、保存结果

### 方式2: 批量预测（从TXT文件）

1. 创建一个TXT文件，每行一个股票代码，例如：
   ```
   000001
   600000
   002594
   600519
   ```

2. 运行程序后，选择 `[2] 从TXT文件读取多个股票代码`
3. 输入TXT文件的路径
4. 程序会依次处理所有股票代码

### 示例文件

本目录下提供了示例文件 `stock_codes_example.txt`，包含以下股票代码：
- 000001 (平安银行)
- 600000 (浦发银行)
- 000002 (万科A)
- 600519 (贵州茅台)
- 002594 (比亚迪)

## 📊 输出结果

程序会在 `examples/stock_predictions/` 目录下生成以下文件：

### 1. CSV文件
- 文件名格式：`prediction_<股票代码>_<时间戳>.csv`
- 包含完整的历史数据和预测数据
- 列：date, open, high, low, close, volume, amount

### 2. PNG图表
- 文件名格式：`prediction_<股票代码>_<时间戳>.png`
- 包含两个子图：
  - 上图：收盘价走势（历史 + 预测）
  - 下图：成交量对比（历史 + 预测）

## ⚙️ 配置参数

可以在 `stock_prediction_interactive.py` 文件顶部修改以下参数：

```python
LOOKBACK = 100      # 使用的历史数据长度（交易日）
PRED_LEN = 20       # 预测的未来长度（交易日）
DEVICE = "cpu"      # 使用的设备（"cpu" 或 "cuda:0"）
T = 1.0             # 采样温度
TOP_P = 0.9         # Top-p采样参数
```

## 📝 注意事项

1. **股票代码格式**：使用6位数字代码，如 `000001`（不需要加 .SZ 或 .SH 后缀）

2. **数据来源**：使用akshare获取数据，需要网络连接

3. **预测限制**：
   - 自动应用中国A股±10%涨跌幅限制
   - 预测结果仅供参考，不构成投资建议

4. **性能建议**：
   - 如果有NVIDIA GPU，可将 `DEVICE` 改为 `"cuda:0"` 以加速预测
   - 批量预测时，程序会在每个股票之间暂停2秒，避免请求过快

5. **数据要求**：
   - 至少需要100个交易日的历史数据
   - 如果数据不足，程序会自动调整

## 🛠️ 故障排除

### 问题1: 无法获取股票数据
- **原因**：股票代码错误或网络问题
- **解决**：检查股票代码是否正确，确保网络连接正常

### 问题2: 模型加载失败
- **原因**：模型文件未下载或路径错误
- **解决**：确保 `NeoQuasar/` 目录下有相应的模型文件

### 问题3: 预测速度慢
- **原因**：使用CPU进行推理
- **解决**：如果有GPU，将 `DEVICE` 改为 `"cuda:0"`

## 📧 技术支持

如有问题，请参考：
- Kronos项目主页：[GitHub](https://github.com/...)
- akshare文档：https://akshare.akfamily.xyz/

## ⚖️ 免责声明

本程序仅供学习和研究使用。预测结果不构成任何投资建议。
股市有风险，投资需谨慎。使用本程序进行投资决策所产生的任何损失，作者不承担任何责任。

---

**祝您使用愉快！**
